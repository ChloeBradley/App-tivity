<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>


  <h2 id="tagline" class="text-branding text-jumbo text-contrast row-space-1 eventsIndex">
    Happenings
    <%= button_to "Home", root_path, class: "myButton2", method: :get  %>
  </h2>


<body class="opc-body">
  <div class="container-fluid">

     <div class="form-group2">
      <%= form_tag events_path, method: "get" do %>

        <%= label_tag :search, "Search", class: 'control-label' %>
        <%= text_field_tag :search,"", autofocus: true  %>

        <%= label_tag :location, "Location", class: 'control-label' %>
        <%= text_field_tag :location %>

        <%= submit_tag "Make My Day", class: "myButton"  %>
      <% end %>
    </div>

  <% if @events == "No events Found" %>
    <%= "No events Found" %>
  <% else %>

    <h3>Your search returned <%= @events.count %> results </h3>
    <hr>

    <% @events.each do |event| %>
      <% if event["title"] && event["description"].present? %>

       <div class="row">

          <div class="col-md-3 image-styling">
            <% if event["image"] && event["image"]["medium"]%>
              <%=link_to image_tag event["image"]["medium"]["url"] %>
            <% end %>
          </div><!--end col-->

          <div class="col-md-9">
            <div class="resultsTitle">
             <h1> <%= event["title"] %> </h1>
            </div>

            <% if strip_tags(event["description"]) %>
              <div class= "descriptionStyle">
                 <%= strip_tags(event["description"]).gsub('&amp;', '&').gsub('&quot;', '"') %>
              </div>
            <% end %>
          </div><!--end col-->

        </div><!--end row-->

      <% end %> <!-- ends title and description present-->
    <% end %> <!--end of do loop -->
  <% end %><!-- end of if else -->
</div> <!-- end container-fluid -->


  <div style='width: 1080.99px; margin-left: auto; margin-right: auto;'>
    <div id="map" style='width: 1080.99px; height: 600px; border: 4px solid black;'></div>
  </div>

</body>

    <script type="text/javascript">
      handler = Gmaps.build('Google');
      handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    </script>
